<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Peta RDTR Kota Mojokerto</title>
    <link rel="stylesheet" href="https://js.arcgis.com/4.24/esri/themes/light/main.css">
    <script src="https://js.arcgis.com/4.24/"></script>
    <style>
      html,
      body,
      #viewDiv {
        padding: 0;
        margin: 0;
        height: 100%;
        width: 100%;
      }
    </style>
    <script>
      require([
        "esri/Map",
        "esri/views/MapView",
        "esri/layers/GeoJSONLayer",
        "esri/Basemap",
        "esri/widgets/BasemapGallery",
        "esri/widgets/Expand",
        "esri/widgets/AreaMeasurement2D"
      ], function (
        Map,
        MapView,
        GeoJSONLayer,
        Basemap,
        BasemapGallery,
        Expand,
        AreaMeasurement2D) {
          // Function untuk warnain layer
          function createFillSymbol(value, color) {
            return {
              "value": value,
              "label": value,
              "symbol": {
                "color": color,
                "type": "simple-fill",
                "style": "solid",
                "outline": {
                  "style": "solid",
                  "width": "0.5px",
                  "color": "#6E6E6E"
                }
              }
            };
          }
          // Bikin simbologi layernya
          const rdtrLayerRenderer = {
            type: "unique-value",
            field: "ZONA",
            uniqueValueInfos: [
              createFillSymbol("Perlindungan Setempat", "#99FF33"), // Functionnya dipanggil
              createFillSymbol("Ruang Terbuka Hijau", "#00E271"),
              createFillSymbol("Zona Campuran", "#E8BEFF"),
              createFillSymbol("Zona Industri", "#9C9C9C"),
              createFillSymbol("Zona Perdagangan dan Jasa", "#EB7878"),
              createFillSymbol("Zona Perkantoran", "#C88CFF"),
              createFillSymbol("Zona Perumahan", "#FAFA6E"),
              createFillSymbol("Zona Peruntukan Khusus", "#CCCCD6"),
              createFillSymbol("Zona Peruntukan Lainnya", "#579687"),
              createFillSymbol("Zona Sarana Pelayanan Umum", "#DCA078"),
            ]
          }
          // Bikin template popup
          const popupPolaRuang = {
            title: "Layer RDTR",
            content: "<b>Zona</b> : {ZONA}<br><hr><b>BWP</b> : {BWP}<br><hr><b>Kode</b> : {KODE}<br><hr><b>SBWP</b> : {SBWP}<br><hr>"
          };
          // Bikin layernya
          const layerPolaRuang = new GeoJSONLayer({
            popupTemplate: popupPolaRuang, // Masukin template popup
            renderer: rdtrLayerRenderer, // Masukin simbologinya disini (rdtrLayerRenderer)
            url: "https://raw.githubusercontent.com/arimatiur/tataruang_mojokerto/main/geojson/polaruang.geojson"
          });
          // Buat map
          const map = new Map({
            basemap: "topo-vector",
            layers: layerPolaRuang // Layernya kalau banyak jadiin array kalau satu langsung objectnya aja
          });
          //Buat mapview dipasang di element viewDiv
          const view = new MapView({
            map: map,
            zoom: 14,
            center: [112.4354276967371, -7.471953679273513],
            popup: {
              dockEnabled: true,
              autoOpenEnabled: true,
              dockOptions: {
                breakpoint: false,
                position: "top-right",
                buttonEnabled: false
              }
            },
            container: "viewDiv"
          });
          //PEMBUATAN WIDGET

          //Basemap Gallery Start
          const streetsvectorBasemap = Basemap.fromId("streets-vector");
          const osmBasemap = Basemap.fromId("osm");
          const satelliteBasemap = Basemap.fromId("satellite");
          const topovectorBasemap = Basemap.fromId("topo-vector");
          const basemapGallery = new BasemapGallery({
            view: view,
            source: [topovectorBasemap, osmBasemap, satelliteBasemap, streetsvectorBasemap]
          });
          //Basemap Gallery End

          //AreaMeasurement2D Start
          const measureWidget = new AreaMeasurement2D({
            view: view
          });
          //AreaMeasurement2D End

          //Expand widget
          const bgExpand = new Expand({
            view: view,
            content: basemapGallery,
            expandIconClass: "esri-icon-basemap"
          });
          view.ui.add(bgExpand, {
            position: "top-left"
          });
          const measureExpand = new Expand({
            view: view,
            content: measureWidget,
            expandIconClass: "esri-icon-measure-area"
          });
          view.ui.add(measureExpand, {
            position: "top-left"
          });
        });
    </script>
  </head>
  <body>
    <div id="viewDiv"></div>
  </body>
</html>
